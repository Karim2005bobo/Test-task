3.2 Алгоритм создания пользователя на стороне бэка

a) Получение запроса
Бэкенд принимает POST-запрос по адресу /api/v1/users/register с JSON, содержащим данные пользователя: имя, фамилия, никнейм, пароль.

b) Проверка данных
- Проверяется наличие всех обязательных полей (firstName, lastName, password, confirmPassword — при наличии).
- Если какого-то поля нет — возвращается ошибка 400 Bad Request.
- Если password и confirmPassword не совпадают (если confirmPassword есть) — ошибка 422 Unprocessable Entity.
- Пароль проверяется на безопасность (длина, цифры, заглавные и строчные буквы). При несоответствии — ошибка 422.

c) Обработка пароля
- Создаётся случайная соль (salt) для усиления безопасности.
- Пароль вместе с солью хэшируется (например, bcrypt).
- В базу сохраняется только хэш, сам пароль не хранится.

d) Формирование уникального ID
- Генерируется уникальный идентификатор пользователя – userId, используя UUID v4.

e) Запись в базу данных
- Создаётся объект пользователя с нужными полями (userId, firstName, lastName, userName, hashedPassword, status).
- Выполняется SQL-запрос на вставку данных в таблицу users.
- Если при вставке возникает ошибка (например, дублирование, проблемы с соединением) — ошибка логируется и сервер возвращает 500 Internal Server Error.
- Убедиться, что транзакция корректно завершилась (commit/rollback).

f) Сохранение дополнительных данных (если нужно)
- При наличии профилей, пользовательских настроек или метаданных (IP, устройство) – они записываются в соответствующие таблицы.

g) Формирование ответа
- Собирается JSON с данными пользователя без пароля и конфиденциальной информации.
- Возвращается статус 201 Created с полями userId, firstName, lastName, userName, status.

h) Завершение обработки

- Отправить ответ клиенту, закрыть соединения с БД и ресурсами.
- Контроллер или сервис заканчивает работу.
